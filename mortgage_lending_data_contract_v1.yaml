# YAML Data Contract - Mortgage Lending Analytics (Synthetic)

dataContractSpecification: 1.2.0

# ============================================================================
# SECTION: Contract Identity & Contacts
# ============================================================================
id: mortgage_lending_analytics_v1_4
info:
  title: Mortgage Lending Analytics (Synthetic)
  version: 1.4.0
  status: active
  description: >
    Contract governing synthetic U.S. mortgage application, appraisal, credit bureau
    summary, and adverse action data for analytics, compliance testing, and model
    development. Governance aligns to HMDA (Reg C), GLBA, and FCRA.
  owner: Ethan Ericson (Data Steward)
  contact:
    name: Ethan Ericson
    email: ericson@uark.edu
    url: https://examplebank.com/data-governance

# ============================================================================
# SECTION: Servers (workspace servers; bronze/silver/gold unchanged; dev/qa/prod patched)
# ============================================================================
servers:
  bronze:
    type: local
    environment: prod
    path: lakehouse/bronze/mortgage_lending/{model}_2024.csv
    format: csv
    description: Raw CSV files per model with ingestion-time validations only

  silver:
    type: local
    environment: prod
    path: lakehouse/silver/mortgage_lending/{model}.delta
    format: delta
    description: Cleansed/validated Delta tables with RBAC-ready classifications

  gold:
    type: local
    environment: prod
    path: lakehouse/gold/mortgage_analytics/{model}.delta
    format: delta
    description: Business-ready marts and certified exports

  dev:
    type: local
    environment: dev
    path: lakehouse/dev/sample/mortgage_lending/{model}.delta
    format: delta
    description: >
      Development workspace with minimally sampled data for pipeline build and
      experimentation. Access limited to ETL Ops and Data Stewards; Restricted
      fields are masked or excluded by default.

  qa:
    type: local
    environment: qa
    path: lakehouse/qa/sample/mortgage_lending/{model}.delta
    format: delta
    description: >
      QA/test workspace with representative subset for validation. Access extends
      to Data Scientists for test runs; Restricted fields available by exception
      through steward-approved, time-bound grants.

  prod:
    type: local
    environment: prod
    path: lakehouse/prod/mortgage_lending/{model}.delta
    format: delta
    description: >
      Production workspace with full dataset under strict RBAC and audit logging.
      Access for Compliance Officers, Underwriters, Analysts, Data Scientists, and
      Auditors is purpose-bound, least-privilege, and time-limited where applicable.

# ============================================================================
# SECTION: RBAC Roles
# ============================================================================
roles:
    - name: ComplianceOfficer
      description: Regulatory oversight; full read with audit responsibilities
    - name: DataSteward
      description: Schema governance and data quality operations
    - name: Underwriter
      description: Credit decisions and reviews; excludes protected demographics & bureau raw fields
    - name: DataScientist
      description: Modeling & analytics; Restricted fields via approval only
    - name: DataAnalyst
      description: Aggregated analytics; no raw Restricted data
    - name: Auditor
      description: Time-bound full read for audits; always logged
    - name: ETLOps
      description: Pipeline operations; minimal PII, technical fields only

# ============================================================================
# SECTION: Terms & Usage
# ============================================================================
terms:
  usage: >
    Permitted for mortgage analytics, HMDA reporting QA, model development, and compliance testing.
    Synthetic data only. If replaced by real consumer data, FCRA permissible purpose and GLBA safeguards apply.
  limitations:
    - No re-identification or linkage intended to identify individuals
    - Exports outside approved environments must be encrypted
    - Public sharing is aggregated only; apply small-cell suppression (min cell size >= 15)
  billing: internal
  noticePeriod: P30D
  policies:
  - name: HMDA_RegC
    description: >
      Home Mortgage Disclosure Act (HMDA), implemented as Regulation C, requires financial institutions
      to collect, report, and publicly disclose loan-level mortgage data to increase transparency and
      monitor for discriminatory lending patterns.
    url: https://www.consumerfinance.gov/rules-policy/regulations/1003/

  - name: GLBA_PrivacySafeguards
    description: >
      Gramm-Leach-Bliley Act (GLBA) Privacy and Safeguards Rules, which mandate financial institutions
      to protect the privacy of customers' nonpublic personal information and implement safeguards to
      secure sensitive financial data.
    url: https://www.ftc.gov/business-guidance/privacy-security/gramm-leach-bliley-act

  - name: FCRA
    description: >
      Fair Credit Reporting Act (FCRA), which governs the collection, use, and sharing of consumer credit
      information, while granting consumers rights to access, dispute, and ensure accuracy of credit reports.
    url: https://www.consumerfinance.gov/compliance/compliance-resources/other-applicable-requirements/fair-credit-reporting-act/

# ============================================================================
# SECTION: Models (schemas with comments + PII/NPI flags for every field)
# ============================================================================
models:

  # --------------------------------------------------------------------------
  # MODEL: applications
  # --------------------------------------------------------------------------
  applications:
    description: Loan application-level facts (1 row per application)
    type: table
    primaryKey: [application_id]
    fields:

      # Primary business key of the application (string UUID or equivalent).
      # Required for joins to appraisals and adverse action.
      application_id:
        type: string
        required: true
        classification: Internal
        pii: false
        npi: false
        tags: [identifier]

      # Internal surrogate for the consumer; links to credit_bureau_summary.customer_id.
      # Marked Restricted due to credit-regulated nature (GLBA/FCRA scope).
      customer_id:
        type: int
        required: true
        classification: Restricted
        pii: true
        npi: false
        tags: [identifier, fk, consumer]

      # Identifier of the subject property; joins to property_appraisals.property_id.
      property_id:
        type: string
        required: true
        classification: Internal
        pii: false
        npi: false
        tags: [identifier, fk]

      # Date the application was initiated (business date).
      application_date:
        type: date
        required: true
        classification: Internal
        pii: false
        npi: true

      # Date of final decision (approve/deny/withdraw/incomplete).
      decision_date:
        type: date
        required: true
        classification: Internal
        pii: false
        npi: true

      # Purpose of loan request; used for HMDA breakdowns and pricing logic.
      loan_purpose:
        type: string
        required: true
        allowed: [purchase, refinance, cash_out, home_improvement]
        classification: Internal
        pii: false
        npi: true

      # Declared occupancy category for the subject property.
      occupancy_type:
        type: string
        required: true
        allowed: [primary, secondary, investment]
        classification: Internal
        pii: false
        npi: true

      # Property type used for eligibility and pricing.
      property_type:
        type: string
        required: true
        allowed: [single_family, condo, multi_family, manufactured]
        classification: Internal
        pii: false
        npi: false

      # Two-letter state/territory code where the property is located.
      property_state:
        type: string
        required: true
        format: US_STATE_ABBR
        classification: Internal
        pii: false
        npi: false

      # Five-digit ZIP code of the property (no ZIP+4 in this dataset).
      property_zip:
        type: string
        required: true
        format: "^[0-9]{5}$"
        classification: Internal
        pii: false
        npi: false

      # Requested/approved principal amount in dollars.
      loan_amount:
        type: decimal
        precision: 12
        scale: 2
        required: true
        classification: Confidential
        pii: false
        npi: true

      # Loan term in months, standardized to common terms.
      loan_term_months:
        type: int
        required: true
        allowed: [120,180,240,360]
        classification: Internal
        pii: false
        npi: true

      # Annual interest rate in percent (e.g., 6.250 = 6.25%).
      interest_rate_percent:
        type: decimal
        precision: 5
        scale: 3
        required: true
        range: [0.0, 100.0]
        classification: Confidential
        pii: false
        npi: true

      # Interest rate type (fixed vs. adjustable).
      rate_type:
        type: string
        required: true
        allowed: [fixed, arm]
        classification: Internal
        pii: false
        npi: true

      # Debt-to-Income ratio in percent (0-100), consistent with dataset fixes.
      dti_percent:
        type: decimal
        precision: 5
        scale: 1
        required: true
        range: [0.0, 100.0]
        classification: Confidential
        pii: false
        npi: true

      # Loan-to-Value ratio in percent (0-100) at decision; reconciled to appraisal.
      ltv_percent:
        type: decimal
        precision: 5
        scale: 2
        required: true
        range: [0.0, 100.0]
        classification: Confidential
        pii: false
        npi: true

      # Borrower annual gross income in USD (pre-tax).
      income_annual:
        type: decimal
        precision: 12
        scale: 2
        required: true
        classification: Restricted
        pii: true
        npi: true

      # True if a co-applicant is present on the application.
      co_applicant:
        type: boolean
        required: true
        classification: Internal
        pii: false
        npi: true

      # Origination channel that captured the application.
      channel:
        type: string
        required: true
        allowed: [retail, broker, online]
        classification: Internal
        pii: false
        npi: false

      # HMDA-style age bucket; restricted for fairness/governance use only.
      applicant_age_bucket:
        type: string
        required: true
        allowed: ["18-24","25-34","35-44","45-54","55-64","65-74","75+"]
        classification: Restricted
        pii: true
        npi: false

      # Applicant self-reported sex; restricted field.
      applicant_sex:
        type: string
        required: true
        allowed: [male, female, not_provided]
        classification: Restricted
        pii: true
        npi: false

      # Applicant self-reported ethnicity; restricted field.
      applicant_ethnicity:
        type: string
        required: true
        allowed: [hispanic_or_latino, not_hispanic_or_latino, not_provided]
        classification: Restricted
        pii: true
        npi: false

      # Applicant self-reported race; restricted field.
      applicant_race:
        type: string
        required: true
        allowed: [white, black_or_african_american, asian, american_indian_or_alaska_native, native_hawaiian_or_pacific_islander, two_or_more, not_provided]
        classification: Restricted
        pii: true
        npi: false

      # Final underwriting decision for the application.
      decision:
        type: string
        required: true
        allowed: [approved, denied, withdrawn, incomplete]
        classification: Internal
        pii: false
        npi: true

      # Specific denial reason; optional unless decision is denied/incomplete.
      denial_reason_code:
        type: string
        required: false
        allowed: [DTI_TOO_HIGH, CREDIT_SCORE_LOW, LTV_TOO_HIGH, INCOMPLETE, OTHER, ""]
        classification: Confidential
        pii: false
        npi: true

      # HMDA action taken code mapped from decision for reporting QA.
      hmda_action_taken:
        type: string
        required: true
        allowed: ["1_ORIGINATED","3_DENIED","4_WITHDRAWN","5_FILE_CLOSED_FOR_INCOMPLETENESS"]
        classification: Internal
        pii: false
        npi: true

    quality:
      # Application date must not be after decision date.
      - type: sql
        description: Application date must be on/before decision date
        query: |
          SELECT COUNT(*) FROM {table}
          WHERE DATE(application_date) > DATE(decision_date)
        mustBe: 0

      # Check that implied LTV from loan_amount and appraisal ~= stored ltv_percent.
      - type: sql
        description: Loan amount consistency with appraisal (±10% tolerance on implied LTV)
        query: |
          SELECT COUNT(*)
          FROM applications a
          JOIN property_appraisals p ON a.property_id = p.property_id
          WHERE ABS(a.loan_amount / NULLIF(p.appraised_value,0) * 100 - a.ltv_percent) > 10
        mustBe: 0

      # HMDA action must align with internal decision state.
      - type: sql
        description: HMDA mapping must be consistent with decision
        query: |
          SELECT COUNT(*) FROM {table}
          WHERE (decision = 'approved'   AND hmda_action_taken <> '1_ORIGINATED') OR
                (decision = 'denied'     AND hmda_action_taken <> '3_DENIED')    OR
                (decision = 'withdrawn'  AND hmda_action_taken <> '4_WITHDRAWN') OR
                (decision = 'incomplete' AND hmda_action_taken <> '5_FILE_CLOSED_FOR_INCOMPLETENESS')
        mustBe: 0

      # Cross-model integrity — every property on an application must be appraised.
      - type: sql
        description: All applications.property_id must exist in property_appraisals
        query: |
          SELECT COUNT(*) FROM applications a
          LEFT JOIN property_appraisals p ON a.property_id = p.property_id
          WHERE p.property_id IS NULL
        mustBe: 0

      # Cross-model integrity — every application customer must have a bureau summary.
      - type: sql
        description: All applications.customer_id must exist in credit_bureau_summary
        query: |
          SELECT COUNT(*) FROM applications a
          LEFT JOIN credit_bureau_summary b ON a.customer_id = b.customer_id
          WHERE b.customer_id IS NULL
        mustBe: 0

  # --------------------------------------------------------------------------
  # MODEL: property_appraisals
  # --------------------------------------------------------------------------
  property_appraisals:
    description: Appraisal/valuation details for subject property
    type: table
    primaryKey: [property_id]
    fields:

      # Property identifier (matches applications.property_id).
      property_id:
        type: string
        required: true
        classification: Internal
        pii: false
        npi: false

      # Owning application; 1:1 with applications by property_id in this dataset.
      application_id:
        type: string
        required: true
        classification: Internal
        pii: false
        npi: false
        tags: [fk]

      # Appraised value in USD from appraisal/AVM.
      appraised_value:
        type: decimal
        precision: 12
        scale: 2
        required: true
        classification: Confidential
        pii: false
        npi: true

      # Date of valuation event.
      valuation_date:
        type: date
        required: true
        classification: Internal
        pii: false
        npi: true

      # Method used for valuation (full, exterior-only, desktop, or AVM).
      valuation_method:
        type: string
        required: true
        allowed: [full_appraisal, exterior_only, desktop, avm]
        classification: Internal
        pii: false
        npi: true

      # AVM confidence (0.0-1.0). Required when valuation_method = avm.
      avm_confidence_score:
        type: decimal
        precision: 4
        scale: 3
        required: false
        range: [0.0, 1.0]
        classification: Internal
        pii: false
        npi: true

      # FEMA flood zone code at the property location.
      fema_flood_zone:
        type: string
        required: true
        allowed: [X, AE, VE, AO, AH]
        classification: Internal
        pii: false
        npi: false

      # Census tract identifier for fair lending analytics.
      census_tract:
        type: string
        required: true
        classification: Internal
        pii: false
        npi: false

      # Latitude in decimal degrees (WGS84); precision to ~0.11m.
      property_latitude:
        type: decimal
        precision: 9
        scale: 6
        required: true
        classification: Internal
        pii: false
        npi: false

      # Longitude in decimal degrees (WGS84); precision to ~0.11m.
      property_longitude:
        type: decimal
        precision: 9
        scale: 6
        required: true
        classification: Internal
        pii: false
        npi: false

    quality:
      # If valuation uses AVM, confidence score must be provided.
      - type: sql
        description: If valuation_method = 'avm', confidence score must be present
        query: |
          SELECT COUNT(*) FROM {table}
          WHERE valuation_method = 'avm' AND (avm_confidence_score IS NULL)
        mustBe: 0

  # --------------------------------------------------------------------------
  # MODEL: credit_bureau_summary
  # --------------------------------------------------------------------------
  credit_bureau_summary:
    description: Consumer credit summary used for underwriting and compliance analytics
    type: table
    primaryKey: [customer_id]
    fields:

      # Surrogate person key used to link to applications.customer_id.
      customer_id:
        type: int
        required: true
        classification: Restricted
        pii: true
        npi: false
        tags: [identifier]

      # Base FICO® score (300-850) captured at application time.
      fico_score:
        type: int
        required: true
        range: [300, 850]
        classification: Restricted
        pii: true
        npi: true

      # Count of currently open credit tradelines.
      tradelines_open:
        type: int
        required: true
        range: [0, 99]
        classification: Restricted
        pii: true
        npi: true

      # Count of delinquent tradelines.
      tradelines_delinquent:
        type: int
        required: true
        range: [0, 99]
        classification: Restricted
        pii: true
        npi: true

      # Number of hard inquiries in the last 12 months.
      inquiries_last_12m:
        type: int
        required: true
        range: [0, 99]
        classification: Restricted
        pii: true
        npi: true

      # Revolving utilization (0-100%) across revolving accounts.
      revolving_utilization_percent:
        type: decimal
        precision: 5
        scale: 1
        required: true
        range: [0.0, 100.0]
        classification: Restricted
        pii: true
        npi: true

      # Age of credit history in years (decimal).
      credit_age_years:
        type: decimal
        precision: 5
        scale: 1
        required: true
        range: [0.0, 100.0]
        classification: Restricted
        pii: true
        npi: true

      # Bankruptcy indicator derived from bureau public records.
      bankruptcy_flag:
        type: boolean
        required: true
        classification: Restricted
        pii: true
        npi: true

      # Count of adverse public records; must be >=1 if bankruptcy_flag = true.
      public_records_count:
        type: int
        required: true
        range: [0, 9]
        classification: Restricted
        pii: true
        npi: true

    quality:
      # Enforce business rule: bankruptcy implies >= 1 public record.
      - type: sql
        description: Bankruptcy implies at least one public record event
        query: |
          SELECT COUNT(*) FROM {table}
          WHERE bankruptcy_flag = TRUE AND (public_records_count IS NULL OR public_records_count < 1)
        mustBe: 0

  # --------------------------------------------------------------------------
  # MODEL: adverse_action_notices
  # --------------------------------------------------------------------------
  adverse_action_notices:
    description: Adverse action notices for denied/incomplete applications
    type: table
    primaryKey: [notice_id]
    fields:

      # Primary key of the notice record.
      notice_id:
        type: string
        required: true
        classification: Confidential
        pii: false
        npi: false

      # Application the notice refers to; joins to applications.application_id.
      application_id:
        type: string
        required: true
        classification: Internal
        pii: false
        npi: false
        tags: [fk]

      # Customer associated with the notice; aligns with applications.customer_id.
      customer_id:
        type: int
        required: true
        classification: Restricted
        pii: true
        npi: false

      # Date the adverse action notice was issued.
      notice_date:
        type: date
        required: true
        classification: Internal
        pii: false
        npi: true

      # Primary regulatory reason code communicated to the applicant.
      denial_reason_code:
        type: string
        required: true
        allowed: [DTI_TOO_HIGH, CREDIT_SCORE_LOW, LTV_TOO_HIGH, INCOMPLETE, OTHER]
        classification: Confidential
        pii: false
        npi: true

    quality:
      # FCRA timeliness: notice must be sent within 30 days of decision for denied/incomplete.
      - type: sql
        description: Every denied/incomplete application must have a notice within 30 days
        query: |
          SELECT COUNT(*)
          FROM applications a
          LEFT JOIN adverse_action_notices n ON a.application_id = n.application_id
          WHERE a.decision IN ('denied','incomplete')
            AND (n.notice_id IS NULL OR DATE(n.notice_date) > DATE(a.decision_date, '+30 day'))
        mustBe: 0

      # Coherent explanation: denial reason aligns to strongest failing factor.
      - type: sql
        description: Denial reason should align with strongest failing factor
        query: |
          SELECT COUNT(*)
          FROM applications a
          JOIN credit_bureau_summary b ON a.customer_id = b.customer_id
          JOIN adverse_action_notices n ON a.application_id = n.application_id
          WHERE a.decision = 'denied' AND NOT (
            (a.dti_percent > 50 AND n.denial_reason_code = 'DTI_TOO_HIGH') OR
            (a.dti_percent <= 50 AND b.fico_score < 640 AND n.denial_reason_code = 'CREDIT_SCORE_LOW') OR
            (a.dti_percent <= 50 AND b.fico_score >= 640 AND a.ltv_percent > 95 AND n.denial_reason_code = 'LTV_TOO_HIGH') OR
            (n.denial_reason_code IN ('OTHER'))
          )
        mustBe: 0

# ============================================================================
# SECTION: Service Levels (allowed at root in v1.2.0)
# ============================================================================
servicelevels:
  availability:
    description: Dataset accessible 24/7 except planned maintenance
    percentage: "99.5%"
  retention:
    description: Synthetic data retained for course term; if real data, follow records policy (>= 7 years for credit decisions)
    period: P7Y
    timestampField: decision_date
  latency:
    description: Silver updated within 6 hours of Bronze arrival
    threshold: 6h
    sourceTimestampField: application_date
  freshness:
    description: Daily refresh by 08:00 local time
    threshold: 24h
    timestampField: decision_date
  frequency:
    description: Daily batch ingestion and validation
    type: batch
    interval: daily

# ============================================================================
# SECTION: Custom Governance Extension (non-standard keys enclosed here)
# ============================================================================
x-uark-governance:

  # PII Inventory
  piiInventory:
    direct_identifiers:
      - field: "customer_id"
        type: "internal_customer_identifier"
        sensitivity: "high"
        masking_required: true

    personal_attributes:
      - field: "applicant_age_bucket"
        type: "age_bucket"
        sensitivity: "high"
      - field: "applicant_sex"
        type: "sex"
        sensitivity: "high"
      - field: "applicant_ethnicity"
        type: "ethnicity"
        sensitivity: "high"
      - field: "applicant_race"
        type: "race"
        sensitivity: "high"

    contact_information: []

    location_data: []

    financial_information:
      - field: "income_annual"
        type: "income_amount"
        sensitivity: "high"
        access_restricted: true
        masking_required: true
      - field: "fico_score"
        type: "credit_score"
        sensitivity: "high"
        access_restricted: true
      - field: "bankruptcy_flag"
        type: "bankruptcy_status"
        sensitivity: "high"
        access_restricted: true
      - field: "public_records_count"
        type: "public_record_count"
        sensitivity: "high"
        access_restricted: true
      - field: "tradelines_open"
        type: "credit_tradeline_count"
        sensitivity: "high"
        access_restricted: true
      - field: "tradelines_delinquent"
        type: "credit_tradeline_delinquent_count"
        sensitivity: "high"
        access_restricted: true
      - field: "inquiries_last_12m"
        type: "credit_inquiry_count"
        sensitivity: "high"
        access_restricted: true
      - field: "revolving_utilization_percent"
        type: "credit_utilization"
        sensitivity: "high"
        access_restricted: true
      - field: "credit_age_years"
        type: "credit_history_age"
        sensitivity: "high"
        access_restricted: true

  # NPI Inventory
  npiInventory:
    credit_report_data:
      - field: "fico_score"
        type: "credit_score"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward","DataScientist"]
      - field: "tradelines_open"
        type: "credit_tradeline_count"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward","DataScientist"]
      - field: "tradelines_delinquent"
        type: "credit_tradeline_delinquent_count"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward","DataScientist"]
      - field: "inquiries_last_12m"
        type: "credit_inquiry_count"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward","DataScientist"]
      - field: "revolving_utilization_percent"
        type: "credit_utilization"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward","DataScientist"]
      - field: "credit_age_years"
        type: "credit_history_age"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward","DataScientist"]
      - field: "bankruptcy_flag"
        type: "bankruptcy_status"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward"]
      - field: "public_records_count"
        type: "public_record_count"
        sensitivity: "high"
        access_restricted: true
        authorized_roles: ["ComplianceOfficer","Auditor","DataSteward"]
    
    transactional_loan_data:
      - field: "application_date"
        type: "application_date"
        sensitivity: "medium"
        access_restricted: true
      - field: "decision_date"
        type: "decision_date"
        sensitivity: "medium"
        access_restricted: true
      - field: "loan_purpose"
        type: "loan_purpose"
        sensitivity: "medium"
        access_restricted: false
      - field: "occupancy_type"
        type: "occupancy_type"
        sensitivity: "medium"
        access_restricted: false
      - field: "loan_amount"
        type: "loan_amount"
        sensitivity: "high"
        access_restricted: true
      - field: "loan_term_months"
        type: "loan_term"
        sensitivity: "medium"
        access_restricted: false
      - field: "interest_rate_percent"
        type: "interest_rate"
        sensitivity: "high"
        access_restricted: true
      - field: "rate_type"
        type: "rate_type"
        sensitivity: "medium"
        access_restricted: false
      - field: "dti_percent"
        type: "debt_to_income_ratio"
        sensitivity: "high"
        access_restricted: true
      - field: "ltv_percent"
        type: "loan_to_value_ratio"
        sensitivity: "high"
        access_restricted: true
      - field: "income_annual"
        type: "income_amount"
        sensitivity: "high"
        access_restricted: true
      - field: "decision"
        type: "credit_decision"
        sensitivity: "medium"
        access_restricted: true
      - field: "denial_reason_code"
        type: "adverse_action_reason"
        sensitivity: "high"
        access_restricted: true
      - field: "hmda_action_taken"
        type: "hmda_action_code"
        sensitivity: "medium"
        access_restricted: true
    
    property_valuation_data:
      - field: "appraised_value"
        type: "appraised_value"
        sensitivity: "medium"
        access_restricted: true
      - field: "valuation_date"
        type: "valuation_date"
        sensitivity: "low"
        access_restricted: false
      - field: "valuation_method"
        type: "valuation_method"
        sensitivity: "low"
        access_restricted: false
      - field: "avm_confidence_score"
        type: "avm_confidence"
        sensitivity: "low"
        access_restricted: false

  # Access Control Policies
  accessControl:
    enforcement: role_based_access_control
    authentication: enterprise_idp

    # Data Classifications
    classifications:
      Public: Aggregated metrics and non-sensitive documentation
      Internal: Operational loan data without consumer attributes
      Confidential: Business-sensitive loan/pricing fields
      Restricted: Regulated personal/credit data (GLBA/FCRA)

    maskingRules:
      dynamicMasking:
        Restricted: mask-value
      smallCellSuppression:
        threshold: 15

    rolePermissions:
      ComplianceOfficer:
        purpose: "Regulatory oversight, investigations, model/fair-lending monitoring"
        data_access_level: "individual_records_unmasked"
        individual_records: true
        fields_excluded: []
        fields_included: ["*"]
        max_classification_access_lvl: Restricted
        pii_access: true
        npi_access: true
        approval_required: false
        business_justification: "Provide continuous regulatory compliance assurance and respond to exams/inquiries"

      DataSteward:
        purpose: "Schema governance, data curation, and data-quality triage"
        data_access_level: "individual_records_masked"
        individual_records: true
        fields_excluded: []
        fields_included: ["*"]
        max_classification_access_lvl: Restricted
        pii_access: conditional
        npi_access: conditional
        approval_required: true
        business_justification: "Enable governance operations while upholding minimization and least privilege"

      Underwriter:
        purpose: "Loan underwriting and credit decision reviews"
        data_access_level: "individual_records_masked"
        individual_records: true
        fields_excluded:
          - "applicant_age_bucket"
          - "applicant_sex"
          - "applicant_ethnicity"
          - "applicant_race"
          - "fico_score"
          - "bankruptcy_flag"
          - "public_records_count"
          - "tradelines_open"
          - "tradelines_delinquent"
          - "inquiries_last_12m"
          - "revolving_utilization_percent"
          - "credit_age_years"
        fields_included:
          - "application_id"
          - "customer_id"              # masked/tokenized
          - "property_id"
          - "application_date"
          - "decision_date"
          - "loan_purpose"
          - "occupancy_type"
          - "property_type"
          - "property_state"
          - "property_zip"
          - "loan_amount"
          - "loan_term_months"
          - "interest_rate_percent"
          - "rate_type"
          - "dti_percent"
          - "ltv_percent"
          - "income_annual"            # masked/rounded as configured
          - "co_applicant"
          - "channel"
          - "decision"
          - "denial_reason_code"
          - "hmda_action_taken"
        max_classification_access_lvl: Restricted
        pii_access: false
        npi_access: false
        approval_required: false
        business_justification: "Perform credit decisions using operational features without exposure to protected classes or raw bureau NPPI"

      DataScientist:
        purpose: "Feature engineering, model training/validation, and fairness analysis"
        data_access_level: "individual_records_masked"
        individual_records: true
        fields_excluded:
          - "applicant_age_bucket"
          - "applicant_sex"
          - "applicant_ethnicity"
          - "applicant_race"
          - "fico_score"
          - "bankruptcy_flag"
          - "public_records_count"
          - "tradelines_open"
          - "tradelines_delinquent"
          - "inquiries_last_12m"
          - "revolving_utilization_percent"
          - "credit_age_years"
        fields_included:
          - "application_id"           # masked/tokenized
          - "customer_id"              # masked/tokenized
          - "property_id"
          - "application_date"
          - "decision_date"
          - "loan_purpose"
          - "occupancy_type"
          - "property_type"
          - "property_state"
          - "property_zip"
          - "loan_amount"
          - "loan_term_months"
          - "interest_rate_percent"
          - "rate_type"
          - "dti_percent"
          - "ltv_percent"
          - "income_annual"            # masked/perturbed by default
          - "co_applicant"
          - "channel"
          - "decision"
          - "denial_reason_code"
          - "hmda_action_taken"
        max_classification_access_lvl: Confidential
        pii_access: by_request
        npi_access: by_request
        approval_required: true
        expiry: P90D
        business_justification: "Build and validate models while honoring minimization; elevate only when necessary"

      DataAnalyst:
        purpose: "Business intelligence and dashboarding"
        data_access_level: "aggregated_only"
        individual_records: false
        fields_included: []
        max_classification_access_lvl: Confidential
        pii_access: false
        npi_access: false
        approval_required: false
        business_justification: "Deliver analytics from de-identified aggregates; avoid Restricted/NPPI exposure"

      Auditor:
        purpose: "Internal/external audit procedures and regulatory examinations"
        data_access_level: "individual_records_unmasked"
        individual_records: true
        fields_excluded: []
        fields_included: ["*"]
        max_classification_access_lvl: Restricted
        pii_access: true
        npi_access: true
        approval_required: true
        expiry: P30D
        business_justification: "Provide evidence and testing capabilities during formal audits and examinations"

      ETLOps:
        purpose: "Operate data pipelines and troubleshoot data quality"
        data_access_level: "individual_records_masked"
        individual_records: true
        fields_excluded:
          - "applicant_age_bucket"
          - "applicant_sex"
          - "applicant_ethnicity"
          - "applicant_race"
          - "fico_score"
          - "bankruptcy_flag"
          - "public_records_count"
          - "tradelines_open"
          - "tradelines_delinquent"
          - "inquiries_last_12m"
          - "revolving_utilization_percent"
          - "credit_age_years"
          - "income_annual"
          - "denial_reason_code"
        fields_included:
          - "application_id"           # masked/tokenized
          - "customer_id"              # masked/tokenized
          - "property_id"
          - "application_date"
          - "decision_date"
          - "channel"
          - "decision"
          - "hmda_action_taken"
        max_classification_access_lvl: Internal
        pii_access: false
        npi_access: false
        approval_required: false
        business_justification: "Run and monitor pipelines without exposure to Restricted/NPPI content"

  # Access Request and Approval Workflow
  workflow:
    accessRequest:
      steps:
        - submitRequest: { actor: requester, content: purpose_scope_duration }
        - managerApproval: { actor: manager }
        - stewardReview: { actor: DataSteward, checks: [least_privilege, minimization] }
        - complianceApproval: { actor: ComplianceOfficer, condition: "contains Restricted" }
        - provisionAccess: { actor: ETLOps, expiry: P90D }
      audit:
        logFields: [user, role, purpose, start_time, expiry, columns_granted]
        retention: P1Y

  compliance:
    hmda_reg_c:
      keyControls: [action_taken_mapping, edit_checks, demographic_aggregation_controls]
    glba_privacy_safeguards:
      keyControls: [least_privilege, masking, encryption_at_rest, encryption_in_transit, access_audit]
    fcra:
      keyControls: [permissible_purpose, adverse_action_timeliness, dispute_traceability]

  implementation:
    contractMetadata:
      createdBy: Ethan Ericson
      createdDate: "2025-09-05"
      createdTimezone: America/Chicago
      approvedBy: Data Governance Committee
      approvalDate: pending
      nextReviewDate: "2026-03-05"
    deploymentChecklist:
      - task: data_classification_completed
        status: completed
      - task: compliance_requirements_mapped
        status: completed
      - task: access_controls_configured
        status: pending
      - task: quality_monitoring_implemented
        status: pending
      - task: audit_logging_enabled
        status: pending
      - task: incident_response_documented
        status: pending
      - task: stakeholder_training_completed
        status: pending

# END OF CONTRACT
